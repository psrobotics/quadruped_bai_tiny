l1=0.0291;
l2=0.048;
l3=0.038;
l6=0.0345;
l5=0.033;
l4=0.060;

j1 = 2.6515;
j2 = 2.4754;

pi=3.1415926535;

%force x,y, desired 
f_x=0
f_y=2.5

%foot end pos
x=0.05;
y=0;

for height_step = 0.065:0.00001:0.095
    
    x=0
    y=height_step

b1_p = (x+(l1/2))^2+y^2
b1 = sqrt(b1_p)
a1 = acos( (l2^2+(l3+l6)^2-b1_p)/(2*l2*(l3+l6)) )
ll1 = l3+l6
a2 = acos( (l2^2+b1_p-ll1^2)/(2*l2*b1) )
a3 = atan2( y,(x+l1/2) )

j1 = 1.5*pi-a2-a3
%ik, get desired joint pos first
b2_p = l1^2+l2^2-2*l1*l2*cos(a2+a3);
b2 = sqrt(b2_p);
a4 = asin(l1*sin(a2+a3)/b2);
a5 = a1-a4;
b3_p = b2_p+l3^2-2*b2*l3*cos(a5);
b3 = sqrt(b3_p);

a6 = asin( b2*sin(a5)/b3 );
cc1 = 2*pi-a2-a3-a1-a6;
c3 = acos( (b3_p+l5^2-l4^2)/(2*b3*l5) );

j2 = 1.5*pi-cc1-c3

t_1=- f_y*(l2*cos(j1 - (3*pi)/2) + cos(pi/2 - j1 + asin((sin((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))/(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^(1/2)) + acos((l1^2 + l2^2 + l3^2 - l4^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))/(2*l3*(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^(1/2))))*(l3 + l6)*(((cos((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))/(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^(1/2) - (l2*sin((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))^2*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2))/(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^(3/2))/(- (sin(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))^2*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2))/(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)) + 1)^(1/2) - (l2*sin((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2) + l2^2*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2) - l3^2*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2) + l4^2*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2) + l5^2*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2) - 2*l1^2*l2*cos((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))) - 2*l2*l5^2*cos((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))) - 2*l1*l5*cos(j2 - (3*pi)/2)*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2) + 4*l1*l2*l5*cos((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*cos(j2 - (3*pi)/2)))/(2*l3*(- (l1^2 + l2^2 + l3^2 - l4^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^2/(4*l3^2*(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))) + 1)^(1/2)*(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^(3/2)) + 1)) - f_x*(l2*sin(j1 - (3*pi)/2) - sin(pi/2 - j1 + asin((sin((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))/(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^(1/2)) + acos((l1^2 + l2^2 + l3^2 - l4^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))/(2*l3*(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^(1/2))))*(l3 + l6)*(((cos((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))/(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^(1/2) - (l2*sin((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))^2*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2))/(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^(3/2))/(- (sin(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))^2*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2))/(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)) + 1)^(1/2) - (l2*sin((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2) + l2^2*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2) - l3^2*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2) + l4^2*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2) + l5^2*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2) - 2*l1^2*l2*cos((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))) - 2*l2*l5^2*cos((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))) - 2*l1*l5*cos(j2 - (3*pi)/2)*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2) + 4*l1*l2*l5*cos((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*cos(j2 - (3*pi)/2)))/(2*l3*(- (l1^2 + l2^2 + l3^2 - l4^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^2/(4*l3^2*(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))) + 1)^(1/2)*(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^(3/2)) + 1))
t_2=f_y*cos(pi/2 - j1 + asin((sin((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))/(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^(1/2)) + acos((l1^2 + l2^2 + l3^2 - l4^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))/(2*l3*(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^(1/2))))*(l3 + l6)*(((l1*l5*sin(j2 - (3*pi)/2)*sin((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))))/((l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)*(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^(1/2)) - (sin((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)*(2*l1*l5*sin(j2 - (3*pi)/2) - (2*l1*l2*l5*sin(j2 - (3*pi)/2)*cos((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2) + (2*l2*l5*sin((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2*cos(j2 - (3*pi)/2) + l5^2*cos(j2 - (3*pi)/2) - l1*l5 - l1*l5*cos(j2 - (3*pi)/2)^2))/(((l1 - l5*cos(j2 - (3*pi)/2))^2/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2))^(1/2)*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2))))/(2*(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^(3/2)) + (l5*cos((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2*cos(j2 - (3*pi)/2) + l5^2*cos(j2 - (3*pi)/2) - l1*l5 - l1*l5*cos(j2 - (3*pi)/2)^2))/(((l1 - l5*cos(j2 - (3*pi)/2))^2/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2))^(1/2)*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)*(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^(1/2)))/(- (sin(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))^2*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2))/(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)) + 1)^(1/2) - ((2*l1*l5*sin(j2 - (3*pi)/2) - (2*l1*l2*l5*sin(j2 - (3*pi)/2)*cos((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2) + (2*l2*l5*sin((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2*cos(j2 - (3*pi)/2) + l5^2*cos(j2 - (3*pi)/2) - l1*l5 - l1*l5*cos(j2 - (3*pi)/2)^2))/(((l1 - l5*cos(j2 - (3*pi)/2))^2/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2))^(1/2)*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)))/(2*l3*(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^(1/2)) - ((2*l1*l5*sin(j2 - (3*pi)/2) - (2*l1*l2*l5*sin(j2 - (3*pi)/2)*cos((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2) + (2*l2*l5*sin((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2*cos(j2 - (3*pi)/2) + l5^2*cos(j2 - (3*pi)/2) - l1*l5 - l1*l5*cos(j2 - (3*pi)/2)^2))/(((l1 - l5*cos(j2 - (3*pi)/2))^2/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2))^(1/2)*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)))*(l1^2 + l2^2 + l3^2 - l4^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))/(4*l3*(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^(3/2)))/(- (l1^2 + l2^2 + l3^2 - l4^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^2/(4*l3^2*(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))) + 1)^(1/2)) - f_x*sin(pi/2 - j1 + asin((sin((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))/(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^(1/2)) + acos((l1^2 + l2^2 + l3^2 - l4^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))/(2*l3*(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^(1/2))))*(l3 + l6)*(((l1*l5*sin(j2 - (3*pi)/2)*sin((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))))/((l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)*(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^(1/2)) - (sin((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)*(2*l1*l5*sin(j2 - (3*pi)/2) - (2*l1*l2*l5*sin(j2 - (3*pi)/2)*cos((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2) + (2*l2*l5*sin((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2*cos(j2 - (3*pi)/2) + l5^2*cos(j2 - (3*pi)/2) - l1*l5 - l1*l5*cos(j2 - (3*pi)/2)^2))/(((l1 - l5*cos(j2 - (3*pi)/2))^2/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2))^(1/2)*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2))))/(2*(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^(3/2)) + (l5*cos((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2*cos(j2 - (3*pi)/2) + l5^2*cos(j2 - (3*pi)/2) - l1*l5 - l1*l5*cos(j2 - (3*pi)/2)^2))/(((l1 - l5*cos(j2 - (3*pi)/2))^2/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2))^(1/2)*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)*(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^(1/2)))/(- (sin(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))^2*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2))/(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)) + 1)^(1/2) - ((2*l1*l5*sin(j2 - (3*pi)/2) - (2*l1*l2*l5*sin(j2 - (3*pi)/2)*cos((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2) + (2*l2*l5*sin((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2*cos(j2 - (3*pi)/2) + l5^2*cos(j2 - (3*pi)/2) - l1*l5 - l1*l5*cos(j2 - (3*pi)/2)^2))/(((l1 - l5*cos(j2 - (3*pi)/2))^2/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2))^(1/2)*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)))/(2*l3*(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^(1/2)) - ((2*l1*l5*sin(j2 - (3*pi)/2) - (2*l1*l2*l5*sin(j2 - (3*pi)/2)*cos((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2) + (2*l2*l5*sin((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2*cos(j2 - (3*pi)/2) + l5^2*cos(j2 - (3*pi)/2) - l1*l5 - l1*l5*cos(j2 - (3*pi)/2)^2))/(((l1 - l5*cos(j2 - (3*pi)/2))^2/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2))^(1/2)*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)))*(l1^2 + l2^2 + l3^2 - l4^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos((3*pi)/2 - j1 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))/(4*l3*(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^(3/2)))/(- (l1^2 + l2^2 + l3^2 - l4^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))^2/(4*l3^2*(l1^2 + l2^2 + l5^2 - 2*l1*l5*cos(j2 - (3*pi)/2) - 2*l2*cos(- j1 + (3*pi)/2 + asin((l5*sin(j2 - (3*pi)/2))/(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2)))*(l1^2 - 2*cos(j2 - (3*pi)/2)*l1*l5 + l5^2)^(1/2))) + 1)^(1/2))
 
plot(height_step,t_1,'r.')
plot(height_step,t_2,'b.')
hold on
end
grid on